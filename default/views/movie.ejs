<!DOCTYPE html>
<html lang="<%- page.language %>" prefix="og: http://ogp.me/ns# video: http://ogp.me/ns/video# ya: http://webmaster.yandex.ru/vocabularies/">

<head>
    <%- include('includes/head.ejs'); -%>
</head>

<body>

<% /* Хлебные крошки */ %>
<a href="/"><%- page.l.home %></a> » <% if (movie.genre_url) { %><%- movie.genre_url %><% } %> » <%= movie.title %>

<% /* Реклама вверху страницы */ %>
<% if (typeof page.adv === 'object' && page.adv.top) { %>
    <div style="text-align:center;margin:10px auto">
        <%- page.adv.top %>
    </div>
<% } %>

<% /* H1 тег */ %>
<h1><%- page.h1 %></h1>

<% /* Информацию о фильме выводить проверяя существование */ %>

<% /* Тип */ %>
<% if (movie.type === 0) { %>Фильм<% } %>
<% if (movie.type === 1) { %>Сериал<% } %>

<% /* ID КиноПоиск */ %>
<% if (movie.kp_id) { %>ID КиноПоиск: <%- movie.kp_id %><% } %>

<% /* ID IMDb */ %>
<% if (movie.imdb_id) { %>ID IMDb: <%- movie.imdb_id %><% } %>

<% /* ID TMDb */ %>
<% if (movie.tmdb_id) { %>ID TMDb: <%- movie.tmdb_id %><% } %>

<% /* ID Douban */ %>
<% if (movie.douban_id) { %>ID Douban: <%- movie.douban_id %><% } %>

<% /* Название фильма */ %>
<%- movie.title %>
<% /* movie.title_ru - перевед. название */ %>
<% /* movie.title_en - ориг. название */ %>
<% /* movie.title_full - перевед. название / ориг. название (год) */ %>
<% /* movie.title_page - название для <title> */ %>

<% /* Описание фильма */ %>
<%- movie.description %>
<% /* movie.description_meta - описание для meta description */ %>
<% /* movie.description_short - короткое описание до 200 симв. */ %>

<% /* Год */ %>
<%- movie.year %>
<% /* movie.year_url - ссылка: <a href="...">год</a> */ %>
<% /* movie.year2 - фильм: год, сериал: 1 сезон 1 серия */ %>
<% /* movie.year3 - фильм: год, сериал: E01S01 */ %>

<% /* Список стран */ %>
<% if (movie.countries) { %><%- page.l.countries %>: <%- movie.countries %><% } %>
<% /* movie.countries_url - список стран в виде ссылок */ %>
<% /* movie.countries_arr - массив стран */ %>
<% /* movie.country - случайная страна */ %>

<% /* Список жанров */ %>
<% if (movie.genres) { %><%- page.l.genres %>: <%- movie.genres %><% } %>
<% /* movie.genres_url - список жанров в виде ссылок */ %>
<% /* movie.genres_arr - массив жанров */ %>
<% /* movie.genre - случайный жанр */ %>

<% /* Список режиссеров */ %>
<% if (movie.directors) { %><%- page.l.directors %>: <%- movie.directors %><% } %>
<% /* movie.directors_url - список режиссеров в виде ссылок */ %>
<% /* movie.directors_arr - массив режиссеров */ %>
<% /* movie.directors - случайный режиссер */ %>

<% /* Список актеров */ %>
<% if (movie.actors) { %><%- page.l.actors %>: <%- movie.actors %><% } %>
<% /* movie.actors_url - список актеров в виде ссылок */ %>
<% /* movie.actors_arr - массив актеров */ %>
<% /* movie.actors - случайный актер */ %>

<% /* Постер фильма */ %>
<img src="<%- movie.poster %>" alt="<%= movie.title %>" id="cinemapress-poster">
<% /* movie.poster_big - большой постер */ %>
<% /* movie.poster - стандартный постер */ %>
<% /* movie.poster_min - маленький постер */ %>

<% /* Кадр из фильма */ %>
<img src="<%- movie.picture %>" alt="<%= movie.title %>">
<% /* movie.picture_big - большой кадр */ %>
<% /* movie.picture - стандартный кадр */ %>
<% /* movie.picture_min - маленький кадр */ %>

<% /* Кадры из фильма */ %>
<% if (movie.pictures && movie.pictures.length) { %>
    <div class="screens" id="lightgallery">
        <% movie.pictures.forEach(function (picture) { %>
            <a href="<%- !page.urls.movies.picture
                    ? picture.picture_big
                    : movie.url + '/' + page.urls.movies.picture %>">
                <img src="<%- picture.picture_min %>" alt="<%= movie.title %>">
            </a>
        <% }); %>
    </div>
    <% if (!page.urls.movies.picture) { %>
        <link href="/themes/default/public/desktop/css/lightgallery.min.css" rel="stylesheet">
        <script src="/themes/default/public/desktop/js/lightgallery.min.js"></script>
        <script>lightGallery(document.getElementById('lightgallery'));</script>
    <% } %>
<% } %>

<% /* Ссылка на фильм */ %>
<a href="<%- movie.url %>"><%= movie.title %></a>
<% /* movie.pathname - URL без домена /movie/idXXX */ %>

<% /* Ссылка на кадры */ %>
<% if (page.urls.movies.picture) { %>
    <a href="<%- movie.url %>/<%- page.urls.movies.picture %>"><%- page.l.picture %></a>
<% } %>
<% /* Ссылка на трейлер */ %>
<% if (page.urls.movies.trailer) { %>
    <a href="<%- movie.url %>/<%- page.urls.movies.trailer %>"><%- page.l.trailer %></a>
<% } %>
<% /* Ссылка на онлайн */ %>
<% if (page.urls.movies.online) { %>
    <a href="<%- movie.url %>/<%- page.urls.movies.online %>"><%- page.l.online %></a>
<% } %>
<% /* Ссылка на скачать */ %>
<% if (page.urls.movies.download) { %>
    <a href="<%- movie.url %>/<%- page.urls.movies.download %>"><%- page.l.download %></a>
<% } %>

<% /* Качество */ %>
<% if (movie.quality) { %><%- page.l.quality %>: <%- movie.quality %><% } %>

<% /* Перевод */ %>
<% if (movie.translate) { %><%- page.l.translate %>: <%- movie.translate %><% } %>

<% /* Общий рейтинг (1-100) и число голосов */ %>
<% if (movie.vote) { %>
    <%- page.l.rating %>: <%- movie.rating %> (<%- movie.vote %> <%- page.l.votes %>)
<% } %>

<% /* КиноПоиск рейтинг (1-100) и число голосов */ %>
<% if (movie.kp_vote) { %>
    <%- page.l.kp %>: <%- movie.kp_rating %> (<%- movie.kp_vote %> <%- page.l.votes %>)
<% } %>

<% /* IMDb рейтинг (1-100) и число голосов */ %>
<% if (movie.imdb_vote) { %>
    <%- page.l.rating %>: <%- movie.imdb_rating %> (<%- movie.imdb_vote %> <%- page.l.votes %>)
<% } %>

<% /* Вышел на экраны или нет */ %>
<% if (movie.passed) { %>Премьера состоялась<% } %>

<% /* Дата премьеры фильма */ %>
<% if (movie.premiere) { %><%- page.l.premiere %>: <%- movie.premiere %><% } %>

<% /* Настраиваемое поле */ %>
<% if (movie && movie.custom && movie.custom["hello"]) { %>
    <%- movie.custom["hello"] %>
<% } %>

<% /* Кнопка «Досмотреть позже» */ %>
<span class="watchLaterBlock" style="display:none;">
    <a href="javascript:void(0)" id="watchLater"><%- page.l.later %></a>
</span>

<% /* Список серий сериала */ %>
<div class="episodesListBlock" style="display:none;margin:10px auto;">
    <div id="episodesList" data-id="<%- movie.kp_id %>"></div>
</div>

<% /* Реклама над плеером */ %>
<% if (typeof page.adv === 'object' && page.adv.over) { %>
    <div style="text-align:center;margin:10px auto;">
        <%- page.adv.over %>
    </div>
<% } %>

<% /* Плеер */ %>
<div id="cinemapress-player">
    <% if (page.player) { %>
        <%- page.player %>
    <% } %>
</div>

<% /* Реклама под плеером */ %>
<% if (typeof page.adv === 'object' && page.adv.under) { %>
    <div style="text-align:center;margin:10px auto;">
        <%- page.adv.under %>
    </div>
<% } %>

<% /* Новости с упоминанием фильма */ %>
<% if (typeof contents === 'object' && contents.length) { %>
    <% contents.forEach(function (content) { %>
        <div style="float:left;width:50%;">
            <div style="margin:0;padding:10px">
                <a href="<%- content.url %>" class="cinemapress-news" style="background-image:url(<%- content.image %>);">
                    <div class="cinemapress-news-title">
                        <%= content.title %>
                    </div>
                </a>
            </div>
        </div>
    <% }); %>
<% } %>

<% /* Цикл блоков связанных фильмов */ %>
<% if (typeof movies === 'object') { %>
    <% for (var type in movies) { %>
        <% if (movies.hasOwnProperty(type) && index[type].length) { %>
            <% movies[type].forEach(function (category) { %>

                <% /* Название блока */ %>
                <h2><%- category.name %></h2>

                <% /* Справа от названия ссылка на случайный фильм из блока */ %>
                <div class="randomMovieIndex">
                    <div class="cinemapress-random-index"
                         onclick="window.location.href='<%- category.url %>?random'"
                         title="<%- page.l.random %>">
                        <img src="/themes/default/public/mobile/dice.svg" alt="<%- page.l.random %>">
                    </div>
                </div>

                <% /* Цикл фильмов в блоке */ %>
                <% if (category.movies.length) { %>
                    <% category.movies.forEach(function (movie) { %>

                        <% /* Информацию о фильме выводить проверяя существование */ %>

                        <% /* Тип */ %>
                        <% if (movie.type === 0) { %>Фильм<% } %>
                        <% if (movie.type === 1) { %>Сериал<% } %>

                        <% /* ID КиноПоиск */ %>
                        <% if (movie.kp_id) { %>ID КиноПоиск: <%- movie.kp_id %><% } %>

                        <% /* ID IMDb */ %>
                        <% if (movie.imdb_id) { %>ID IMDb: <%- movie.imdb_id %><% } %>

                        <% /* ID TMDb */ %>
                        <% if (movie.tmdb_id) { %>ID TMDb: <%- movie.tmdb_id %><% } %>

                        <% /* ID Douban */ %>
                        <% if (movie.douban_id) { %>ID Douban: <%- movie.douban_id %><% } %>

                        <% /* Название фильма */ %>
                        <%- movie.title %>
                        <% /* movie.title_ru - перевед. название */ %>
                        <% /* movie.title_en - ориг. название */ %>
                        <% /* movie.title_full - перевед. название / ориг. название (год) */ %>
                        <% /* movie.title_page - название для <title> */ %>

                        <% /* Описание фильма */ %>
                        <%- movie.description %>
                        <% /* movie.description_meta - описание для meta description */ %>
                        <% /* movie.description_short - короткое описание до 200 симв. */ %>

                        <% /* Год */ %>
                        <%- movie.year %>
                        <% /* movie.year_url - ссылка: <a href="...">год</a> */ %>
                        <% /* movie.year2 - фильм: год, сериал: 1 сезон 1 серия */ %>
                        <% /* movie.year3 - фильм: год, сериал: E01S01 */ %>

                        <% /* Список стран */ %>
                        <% if (movie.countries) { %><%- page.l.countries %>: <%- movie.countries %><% } %>
                        <% /* movie.countries_url - список стран в виде ссылок */ %>
                        <% /* movie.countries_arr - массив стран */ %>
                        <% /* movie.country - случайная страна */ %>

                        <% /* Список жанров */ %>
                        <% if (movie.genres) { %><%- page.l.genres %>: <%- movie.genres %><% } %>
                        <% /* movie.genres_url - список жанров в виде ссылок */ %>
                        <% /* movie.genres_arr - массив жанров */ %>
                        <% /* movie.genre - случайный жанр */ %>

                        <% /* Список режиссеров */ %>
                        <% if (movie.directors) { %><%- page.l.directors %>: <%- movie.directors %><% } %>
                        <% /* movie.directors_url - список режиссеров в виде ссылок */ %>
                        <% /* movie.directors_arr - массив режиссеров */ %>
                        <% /* movie.directors - случайный режиссер */ %>

                        <% /* Список актеров */ %>
                        <% if (movie.actors) { %><%- page.l.actors %>: <%- movie.actors %><% } %>
                        <% /* movie.actors_url - список актеров в виде ссылок */ %>
                        <% /* movie.actors_arr - массив актеров */ %>
                        <% /* movie.actors - случайный актер */ %>

                        <% /* Постер фильма */ %>
                        <img src="<%- movie.poster %>" alt="<%= movie.title %>">
                        <% /* movie.poster_big - большой постер */ %>
                        <% /* movie.poster - стандартный постер */ %>
                        <% /* movie.poster_min - маленький постер */ %>

                        <% /* Кадр из фильма */ %>
                        <img src="<%- movie.picture %>" alt="<%= movie.title %>">
                        <% /* movie.picture_big - большой кадр */ %>
                        <% /* movie.picture - стандартный кадр */ %>
                        <% /* movie.picture_min - маленький кадр */ %>
                        <% /* movie.pictures - массив кадров */ %>

                        <% /* Ссылка на фильм */ %>
                        <a href="<%- movie.url %>"><%= movie.title %></a>
                        <% /* movie.pathname - URL без домена /movie/idXXX */ %>

                        <% /* Ссылка на кадры */ %>
                        <% if (page.urls.movies.picture) { %>
                            <a href="<%- movie.url %>/<%- page.urls.movies.picture %>"><%- page.l.picture %></a>
                        <% } %>
                        <% /* Ссылка на трейлер */ %>
                        <% if (page.urls.movies.trailer) { %>
                            <a href="<%- movie.url %>/<%- page.urls.movies.trailer %>"><%- page.l.trailer %></a>
                        <% } %>
                        <% /* Ссылка на онлайн */ %>
                        <% if (page.urls.movies.online) { %>
                            <a href="<%- movie.url %>/<%- page.urls.movies.online %>"><%- page.l.online %></a>
                        <% } %>
                        <% /* Ссылка на скачать */ %>
                        <% if (page.urls.movies.download) { %>
                            <a href="<%- movie.url %>/<%- page.urls.movies.download %>"><%- page.l.download %></a>
                        <% } %>

                        <% /* Качество */ %>
                        <% if (movie.quality) { %><%- page.l.quality %>: <%- movie.quality %><% } %>

                        <% /* Перевод */ %>
                        <% if (movie.translate) { %><%- page.l.translate %>: <%- movie.translate %><% } %>

                        <% /* Общий рейтинг (1-100) и число голосов */ %>
                        <% if (movie.vote) { %>
                            <%- page.l.rating %>: <%- movie.rating %> (<%- movie.vote %> <%- page.l.votes %>)
                        <% } %>

                        <% /* КиноПоиск рейтинг (1-100) и число голосов */ %>
                        <% if (movie.kp_vote) { %>
                            <%- page.l.kp %>: <%- movie.kp_rating %> (<%- movie.kp_vote %> <%- page.l.votes %>)
                        <% } %>

                        <% /* IMDb рейтинг (1-100) и число голосов */ %>
                        <% if (movie.imdb_vote) { %>
                            <%- page.l.rating %>: <%- movie.imdb_rating %> (<%- movie.imdb_vote %> <%- page.l.votes %>)
                        <% } %>

                        <% /* Вышел на экраны или нет */ %>
                        <% if (movie.passed) { %>Премьера состоялась<% } %>

                        <% /* Дата премьеры фильма */ %>
                        <% if (movie.premiere) { %><%- page.l.premiere %>: <%- movie.premiere %><% } %>

                        <% /* Настраиваемое поле */ %>
                        <% if (movie && movie.custom && movie.custom["hello"]) { %>
                            <%- movie.custom["hello"] %>
                        <% } %>

                    <% }); %>
                <% } %>

            <% }); %>
        <% } %>
    <% } %>
<% } %>

<% /* Блок с комментариями */ %>
<% if (page.comments) { %>
    <%- page.comments %>
<% } else { %>
    <div id="cinemapress-comments">
        <h3 class="cinemapress-comment-h3">
            <%- page.l.comments %>
            <span class="cinemapress-comment-count cinemapress-comment-bg-color"><%- comments && comments.count || '0' %></span>
        </h3>
        <% if (typeof comments === 'object' && typeof comments.config === 'object') { %>
            <% if (comments.config.star_rating) { %>
                <div class="cinemapress-comment-star">
                    <div class="cinemapress-comment-star-down" data-comment-star="1"></div>
                    <div class="cinemapress-comment-star-award" data-comment-star="3"></div>
                    <div class="cinemapress-comment-star-up" data-comment-star="2"></div>
                </div>
            <% } %>
            <div class="cinemapress-comment-form">
                <% if (comments.config.bb_codes) { %>
                    <div class="cinemapress-comment-form-bb">
                        <span class="cinemapress-comment-bg cinemapress-comment-form-bb-b" data-bb-code="b"><%- page.l.bold.toLowerCase() %></span>
                        <span class="cinemapress-comment-bg cinemapress-comment-form-bb-i" data-bb-code="i"><%- page.l.italic.toLowerCase() %></span>
                        <span class="cinemapress-comment-bg cinemapress-comment-form-bb-spoiler" data-bb-code="spoiler">👻 <%- page.l.spoiler.toLowerCase() %></span>
                        <span class="cinemapress-comment-bg cinemapress-comment-form-bb-search" data-bb-code="search">🔍 <%- page.l.search.toLowerCase() %></span>
                        <input class="cinemapress-comment-bg cinemapress-comment-form-anonymous" name="comment_anonymous" type="text" placeholder="<%- page.l.username %>">
                    </div>
                <% } %>
                <div>
                    <div class="cinemapress-comment-textarea-div">
                        <textarea name="comment_text" class="cinemapress-comment-bg cinemapress-comment-textarea" placeholder="<%- page.l.comment %>" autocomplete="off" autocapitalize="off" spellcheck="false"></textarea>
                        <div class="cinemapress-comment-form-bg"></div>
                        <div class="cinemapress-comment-button-bg hover-off" data-comment-type="submit">
                            <span class="cinemapress-comment-button-text"></span>
                        </div>
                    </div>
                    <% if (comments.config.question) { %>
                        <div class="cinemapress-comment-bg cinemapress-comment-question" style="display: none">
                            <div class="cinemapress-comment-question-text"><%- comments.config.question %></div>
                            <div class="cinemapress-comment-question-answer">
                                <% if (comments.config.question_yes) { %>
                                    <span class="cinemapress-comment-question-answer-yes"><%- page.l.yes %></span>
                                <% } %>
                                <% if (comments.config.question_not) { %>
                                    <span class="cinemapress-comment-question-answer-not"><%- page.l.not %></span>
                                <% } %>
                            </div>
                            <% if (comments.config.question_yes) { %>
                                <div class="cinemapress-comment-question-text-yes" style="display: none">
                                    <%- comments.config.question_yes %>
                                </div>
                            <% } %>
                            <% if (comments.config.question_not) { %>
                                <div class="cinemapress-comment-question-text-not" style="display: none">
                                    <%- comments.config.question_not %>
                                </div>
                            <% } %>
                            <div class="cinemapress-comment-question-bg"></div>
                            <% if (comments.config.question_poster) { %>
                                <div class="cinemapress-comment-question-bg-poster" style="background-image:url('<%- comments.config.question_poster %>')"></div>
                            <% } %>
                        </div>
                    <% } %>
                </div>
                <div style="font-size:8px;text-align:right;opacity:.2">This site is protected by reCAPTCHA and the Google <a href="https://policies.google.com/privacy" style="font-size:8px" target="_blank">Privacy Policy</a> and <a href="https://policies.google.com/terms" style="font-size:8px" target="_blank">Terms of Service</a> apply.</div>
            </div>
            <%- comments.indexer ? comments.indexer : '' %>
            <% if (comments.list && comments.list.length) { %>
                <% comments.list.forEach(function (comment) { %>
                    <div class="cinemapress-comment" id="c<%- comment.id %>">
                        <div class="cinemapress-comment-head">
                            <div class="cinemapress-comment-head-avatar">
                                <img src="<%- comment.avatar %>" alt="<%= comment.user %>">
                            </div>
                            <% if (comments.config.star_rating) { %>
                                <% if (comment.star === 1) { %>
                                    <div class="cinemapress-comment-head-star">
                                        <div class="cinemapress-comment-star-down"></div>
                                    </div>
                                <% } else if (comment.star === 2) { %>
                                    <div class="cinemapress-comment-head-star">
                                        <div class="cinemapress-comment-star-up"></div>
                                    </div>
                                <% } else if (comment.star === 3) { %>
                                    <div class="cinemapress-comment-head-star">
                                        <div class="cinemapress-comment-star-award"></div>
                                    </div>
                                <% } %>
                            <% } %>
                            <div class="cinemapress-comment-head-meta">
                                <div class="cinemapress-comment-head-meta-vote">
                                <span class="cinemapress-comment-like" data-comment-type="like" data-comment-id="<%- comment.id %>" title="<%= page.l.like %>">
                                    <span class="cinemapress-comment-like-icon"></span>
                                    <span class="cinemapress-comment-like-number"><%- comment.like %></span>
                                </span>
                                    <span class="cinemapress-comment-dislike" data-comment-type="dislike" data-comment-id="<%- comment.id %>" title="<%= page.l.dislike %>">
                                    <span class="cinemapress-comment-dislike-number"><%- comment.dislike %></span>
                                    <span class="cinemapress-comment-dislike-icon"></span>
                                </span>
                                    <span class="cinemapress-comment-reply" data-reply-id="<%- comment.id %>" data-bb-code="b" data-bb-value="<%- comment.user %>" title="<%= page.l.reply %>">
                                    <span class="cinemapress-comment-reply-icon"></span>
                                </span>
                                </div>
                                <div class="cinemapress-comment-user" data-comment-id="<%- comment.id %>">
                                    <div class="cinemapress-comment-user-name">
                                        <%- comment.user %>
                                    </div><div class="cinemapress-comment-user-said">
                                        <%- page.l.said %>
                                    </div><div class="cinemapress-comment-user-date">
                                        <%- comment.date %>
                                    </div><div class="cinemapress-comment-user-link">
                                        <a href="<%- comment.url %>#c<%- comment.id %>">#</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="cinemapress-comment-bg cinemapress-comment-radius">
                            <%- comment.comment %>
                        </div>
                        <% if (comment.admin) { %>
                            <div class="cinemapress-comment-admin">
                                <div class="cinemapress-comment-bg cinemapress-comment-admin-text">
                                    <%- comment.admin %>
                                </div>
                                <div class="cinemapress-comment-admin-bg"></div>
                            </div>
                        <% } %>
                    </div>
                <% }); %>
            <% } %>
        <% } %>
        <div class="cinemapress-comment-arrow">
            <% if (comments && comments.prev) { %>
                <div class="cinemapress-prev-comments" onclick="window.location.href='?page=<%- comments.prev %>#cinemapress-comments'"></div>
            <% } %>
            <% if (comments && comments.next) { %>
                <div class="cinemapress-next-comments" onclick="window.location.href='?page=<%- comments.next %>#cinemapress-comments'"></div>
            <% } %>
        </div>
    </div>
<% } %>

<% /* Реклама внизу страницы */ %>
<% if (typeof page.adv === 'object' && page.adv.bottom) { %>
    <div style="text-align:center;margin:10px auto">
        <%- page.adv.bottom %>
    </div>
<% } %>

<% /* Описание страницы */ %>
<% if (page.seo) { %>
    <div style="text-align:center;margin:10px auto">
        <%- page.seo %>
    </div>
<% } %>

<%- include('includes/footer.ejs'); -%>

</body>

</html>